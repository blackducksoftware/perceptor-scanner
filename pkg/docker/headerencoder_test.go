/*
Copyright (C) 2018 Synopsys, Inc.

Licensed to the Apache Software Foundation (ASF) under one
or more contributor license agreements. See the NOTICE file
distributed with this work for additional information
regarding copyright ownership. The ASF licenses this file
to you under the Apache License, Version 2.0 (the
"License"); you may not use this file except in compliance
with the License. You may obtain a copy of the License at

http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing,
software distributed under the License is distributed on an
"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, either express or implied. See the License for the
specific language governing permissions and limitations
under the License.
*/

package docker

import (
	"testing"
)

var expected1 = `eyAidXNlcm5hbWUiOiAiYWRtaW4iLCAicGFzc3dvcmQiOiAiZXlKaGJHY2lPaUpTVXpJMU5pSXNJblI1Y0NJNklrcFhWQ0o5LmV5SnBjM01pT2lKcmRXSmxjbTVsZEdWekwzTmxjblpwWTJWaFkyTnZkVzUwSWl3aWEzVmlaWEp1WlhSbGN5NXBieTl6WlhKMmFXTmxZV05qYjNWdWRDOXVZVzFsYzNCaFkyVWlPaUppWkhNdGNHVnlZMlZ3ZEc5eUlpd2lhM1ZpWlhKdVpYUmxjeTVwYnk5elpYSjJhV05sWVdOamIzVnVkQzl6WldOeVpYUXVibUZ0WlNJNkluQmxjbU5sY0hSdmNpMXpZMkZ1Ym1WeUxYTmhMWFJ2YTJWdUxUWm1jM3AwSWl3aWEzVmlaWEp1WlhSbGN5NXBieTl6WlhKMmFXTmxZV05qYjNWdWRDOXpaWEoyYVdObExXRmpZMjkxYm5RdWJtRnRaU0k2SW5CbGNtTmxjSFJ2Y2kxelkyRnVibVZ5TFhOaElpd2lhM1ZpWlhKdVpYUmxjeTVwYnk5elpYSjJhV05sWVdOamIzVnVkQzl6WlhKMmFXTmxMV0ZqWTI5MWJuUXVkV2xrSWpvaU5EVTNOamxqTUdRdE1qRTRNUzB4TVdVNExUZzJaREl0TURZMk4yUTRaV1F3WXpoaElpd2ljM1ZpSWpvaWMzbHpkR1Z0T25ObGNuWnBZMlZoWTJOdmRXNTBPbUprY3kxd1pYSmpaWEIwYjNJNmNHVnlZMlZ3ZEc5eUxYTmpZVzV1WlhJdGMyRWlmUS5qLUY5cjZMQ2FwT2ZSSGlhdXV3UnZjaVFPWDZWZHNZWExmdUFTOVpiMWpUMEVnWGt3RzMxYkNSNXZUbDBTY2hxVlk5Vy00QkpNQ3lqOXcyQW9KcG12UW85eGxrU1d3ZkFwV1hIUmFPTVdMY0taQzlvcVVUcEduWm92QUtBOE54ZXJwZlM2d0FzanAtQm44SEpwZ3h3OUVfeTBrZ2ZOYWxhSWIxLUNQS2NIRjZ2aFBRMzFLNkVEc2ZCRTdGTnlja3JscGc4a2ZsRDlBWEQ0c0JQckk0SE11c1dHUmo4Q05jd0lFZEF2OFRXV3c3amVlVWh4bll0LUhBbWhkQUh0elktenRLNE1YZ1l6ME1ra2pUbHFfcjM1YmV4WC1XTGo2Y1A0NnFBYmY0ZWUzc1hOMWt6LTQ1UHhWaFM1VUhDLV9DOU9KX1lRM19GVm4zbU93Qm9JOGN4NUEiIH0=`

var password1 = `eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJiZHMtcGVyY2VwdG9yIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZWNyZXQubmFtZSI6InBlcmNlcHRvci1zY2FubmVyLXNhLXRva2VuLTZmc3p0Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQubmFtZSI6InBlcmNlcHRvci1zY2FubmVyLXNhIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQudWlkIjoiNDU3NjljMGQtMjE4MS0xMWU4LTg2ZDItMDY2N2Q4ZWQwYzhhIiwic3ViIjoic3lzdGVtOnNlcnZpY2VhY2NvdW50OmJkcy1wZXJjZXB0b3I6cGVyY2VwdG9yLXNjYW5uZXItc2EifQ.j-F9r6LCapOfRHiauuwRvciQOX6VdsYXLfuAS9Zb1jT0EgXkwG31bCR5vTl0SchqVY9W-4BJMCyj9w2AoJpmvQo9xlkSWwfApWXHRaOMWLcKZC9oqUTpGnZovAKA8NxerpfS6wAsjp-Bn8HJpgxw9E_y0kgfNalaIb1-CPKcHF6vhPQ31K6EDsfBE7FNyckrlpg8kflD9AXD4sBPrI4HMusWGRj8CNcwIEdAv8TWWw7jeeUhxnYt-HAmhdAHtzY-ztK4MXgYz0MkkjTlq_r35bexX-WLj6cP46qAbf4ee3sXN1kz-45PxVhS5UHC-_C9OJ_YQ3_FVn3mOwBoI8cx5A`

var abcdefghi = `eyAidXNlcm5hbWUiOiAiYWRtaW4iLCAicGFzc3dvcmQiOiAiZXlKaGJHY2lPaUpTVXpJMU5pSXNJblI1Y0NJNklrcFhWQ0o5LmV5SnBjM01pT2lKcmRXSmxjbTVsZEdWekwzTmxjblpwWTJWaFkyTnZkVzUwSWl3aWEzVmlaWEp1WlhSbGN5NXBieTl6WlhKMmFXTmxZV05qYjNWdWRDOXVZVzFsYzNCaFkyVWlPaUppWkhNdGNHVnlZMlZ3ZEc5eUlpd2lhM1ZpWlhKdVpYUmxjeTVwYnk5elpYSjJhV05sWVdOamIzVnVkQzl6WldOeVpYUXVibUZ0WlNJNkluQmxjbU5sY0hSdmNpMXpZMkZ1Ym1WeUxYTmhMWFJ2YTJWdUxUWm1jM3AwSWl3aWEzVmlaWEp1WlhSbGN5NXBieTl6WlhKMmFXTmxZV05qYjNWdWRDOXpaWEoyYVdObExXRmpZMjkxYm5RdWJtRnRaU0k2SW5CbGNtTmxjSFJ2Y2kxelkyRnVibVZ5TFhOaElpd2lhM1ZpWlhKdVpYUmxjeTVwYnk5elpYSjJhV05sWVdOamIzVnVkQzl6WlhKMmFXTmxMV0ZqWTI5MWJuUXVkV2xrSWpvaU5EVTNOamxqTUdRdE1qRTRNUzB4TVdVNExUZzJaREl0TURZMk4yUTRaV1F3WXpoaElpd2ljM1ZpSWpvaWMzbHpkR1Z0T25ObGNuWnBZMlZoWTJOdmRXNTBPbUprY3kxd1pYSmpaWEIwYjNJNmNHVnlZMlZ3ZEc5eUxYTmpZVzV1WlhJdGMyRWlmUS5qLUY5cjZMQ2FwT2ZSSGlhdXV3UnZjaVFPWDZWZHNZWExmdUFTOVpiMWpUMEVnWGt3RzMxYkNSNXZUbDBTY2hxVlk5Vy00QkpNQ3lqOXcyQW9KcG12UW85eGxrU1d3ZkFwV1hIUmFPTVdMY0taQzlvcVVUcEduWm92QUtBOE54ZXJwZlM2d0FzanAtQm44SEpwZ3h3OUVfeTBrZ2ZOYWxhSWIxLUNQS2NIRjZ2aFBRMzFLNkVEc2ZCRTdGTnlja3JscGc4a2ZsRDlBWEQ0c0JQckk0SE11c1dHUmo4Q05jd0lFZEF2OFRXV3c3amVlVWh4bll0LUhBbWhkQUh0elktenRLNE1YZ1l6ME1ra2pUbHFfcjM1YmV4WC1XTGo2Y1A0NnFBYmY0ZWUzc1hOMWt6LTQ1UHhWaFM1VUhDLV9DOU9KX1lRM19GVm4zbU93Qm9JOGN4NUEiIH0=`

var zzzzzzzzz = `eyAidXNlcm5hbWUiOiAiYWRtaW4iLCAicGFzc3dvcmQiOiAiZXlKaGJHY2lPaUpTVXpJMU5pSXNJblI1Y0NJNklrcFhWQ0o5LmV5SnBjM01pT2lKcmRXSmxjbTVsZEdWekwzTmxjblpwWTJWaFkyTnZkVzUwSWl3aWEzVmlaWEp1WlhSbGN5NXBieTl6WlhKMmFXTmxZV05qYjNWdWRDOXVZVzFsYzNCaFkyVWlPaUppWkhNdGNHVnlZMlZ3ZEc5eUlpd2lhM1ZpWlhKdVpYUmxjeTVwYnk5elpYSjJhV05sWVdOamIzVnVkQzl6WldOeVpYUXVibUZ0WlNJNkluQmxjbU5sY0hSdmNpMXpZMkZ1Ym1WeUxYTmhMWFJ2YTJWdUxUWm1jM3AwSWl3aWEzVmlaWEp1WlhSbGN5NXBieTl6WlhKMmFXTmxZV05qYjNWdWRDOXpaWEoyYVdObExXRmpZMjkxYm5RdWJtRnRaU0k2SW5CbGNtTmxjSFJ2Y2kxelkyRnVibVZ5TFhOaElpd2lhM1ZpWlhKdVpYUmxjeTVwYnk5elpYSjJhV05sWVdOamIzVnVkQzl6WlhKMmFXTmxMV0ZqWTI5MWJuUXVkV2xrSWpvaU5EVTNOamxqTUdRdE1qRTRNUzB4TVdVNExUZzJaREl0TURZMk4yUTRaV1F3WXpoaElpd2ljM1ZpSWpvaWMzbHpkR1Z0T25ObGNuWnBZMlZoWTJOdmRXNTBPbUprY3kxd1pYSmpaWEIwYjNJNmNHVnlZMlZ3ZEc5eUxYTmpZVzV1WlhJdGMyRWlmUS5qLUY5cjZMQ2FwT2ZSSGlhdXV3UnZjaVFPWDZWZHNZWExmdUFTOVpiMWpUMEVnWGt3RzMxYkNSNXZUbDBTY2hxVlk5Vy00QkpNQ3lqOXcyQW9KcG12UW85eGxrU1d3ZkFwV1hIUmFPTVdMY0taQzlvcVVUcEduWm92QUtBOE54ZXJwZlM2d0FzanAtQm44SEpwZ3h3OUVfeTBrZ2ZOYWxhSWIxLUNQS2NIRjZ2aFBRMzFLNkVEc2ZCRTdGTnlja3JscGc4a2ZsRDlBWEQ0c0JQckk0SE11c1dHUmo4Q05jd0lFZEF2OFRXV3c3amVlVWh4bll0LUhBbWhkQUh0elktenRLNE1YZ1l6ME1ra2pUbHFfcjM1YmV4WC1XTGo2Y1A0NnFBYmY0ZWUzc1hOMWt6LTQ1UHhWaFM1VUhDLV9DOU9KX1lRM19GVm4zbU93Qm9JOGN4NUEiIH0=`

var password2 = "abc123def456"

var password3 = "abc123def456sdfjhsafdklhasdkfjlhaslkjhfklashfkjashvnsdvsvkjsadhfkshfkshf3246238946238kjsdjfkhskjfhkashfklashfkashfkjhAHDSFHDKJFHDSKJFHDSKFYERKJHDSFKJDHSFKHSDF"

var expected2 = "eyAidXNlcm5hbWUiOiAiYWRtaW4iLCAicGFzc3dvcmQiOiAiYWJjMTIzZGVmNDU2IiB9"

var expected3 = "eyAidXNlcm5hbWUiOiAiYWRtaW4iLCAicGFzc3dvcmQiOiAiYWJjMTIzZGVmNDU2c2RmamhzYWZka2xoYXNka2ZqbGhhc2xramhma2xhc2hma2phc2h2bnNkdnN2a2pzYWRoZmtzaGZrc2hmMzI0NjIzODk0NjIzOGtqc2RqZmtoc2tqZmhrYXNoZmtsYXNoZmthc2hma2poQUhEU0ZIREtKRkhEU0tKRkhEU0tGWUVSS0pIRFNGS0pESFNGS0hTREYiIH0="

func TestEncoder(t *testing.T) {
	username := "admin"
	header := encodeAuthHeader(username, password1)
	if header != expected1 {
		t.Errorf("\ngot \n%s\nexpected \n%s", header, expected1)
	}
}

func TestEncoderShortPassword(t *testing.T) {
	header := encodeAuthHeader("admin", password2)
	if header != expected2 {
		t.Errorf("got %s, expected %s", header, expected2)
	}
}

func TestEncoderMediumPassword(t *testing.T) {
	header := encodeAuthHeader("admin", password3)
	if header != expected3 {
		t.Errorf("got %s, expected %s", header, expected3)
	}
}

var data4 = `{ "username": "admin", "password": "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJiZHMtcGVyY2VwdG9yIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZWNyZXQubmFtZSI6InBlcmNlcHRvci1zY2FubmVyLXNhLXRva2VuLWZtOWs4Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQubmFtZSI6InBlcmNlcHRvci1zY2FubmVyLXNhIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQudWlkIjoiN2VmOTNjNzktMjI0MC0xMWU4LWI1NTgtMDZlZGE4YzUwOGZhIiwic3ViIjoic3lzdGVtOnNlcnZpY2VhY2NvdW50OmJkcy1wZXJjZXB0b3I6cGVyY2VwdG9yLXNjYW5uZXItc2EifQ.Nh6ah_FIHSU2zd502dq-_gvEakf1OfdIN6TmarFHz5C05CSjPEfi4R96gjBDWkuynFFDyxFiddWbI9YjHR_HylS9kfelUP5s6fVjHywaNrKKgfmB9LzkU67LUochkIruLIyzVbbDV0NMwOaE4M1VV__ejn3TwJpyb0Q3l9dMcZDcbiENYxfRtNNQ4N_ccR51XkGOR0ySOneOZwCHgVE4mliDYtpPGenKtMd6dXMmE4sGfzAtxqqnSShGhbDp1BvjFxy9ZkbWjhUIRSXupJ4A4J4xtrS0lag4ngeRNNOlMa4HNjpgyjT5ZKnnSAqJS6McoBz-P3qOZTy13qkLRHv4BA" }`
var password4 = `eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJiZHMtcGVyY2VwdG9yIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZWNyZXQubmFtZSI6InBlcmNlcHRvci1zY2FubmVyLXNhLXRva2VuLWZtOWs4Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQubmFtZSI6InBlcmNlcHRvci1zY2FubmVyLXNhIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQudWlkIjoiN2VmOTNjNzktMjI0MC0xMWU4LWI1NTgtMDZlZGE4YzUwOGZhIiwic3ViIjoic3lzdGVtOnNlcnZpY2VhY2NvdW50OmJkcy1wZXJjZXB0b3I6cGVyY2VwdG9yLXNjYW5uZXItc2EifQ.Nh6ah_FIHSU2zd502dq-_gvEakf1OfdIN6TmarFHz5C05CSjPEfi4R96gjBDWkuynFFDyxFiddWbI9YjHR_HylS9kfelUP5s6fVjHywaNrKKgfmB9LzkU67LUochkIruLIyzVbbDV0NMwOaE4M1VV__ejn3TwJpyb0Q3l9dMcZDcbiENYxfRtNNQ4N_ccR51XkGOR0ySOneOZwCHgVE4mliDYtpPGenKtMd6dXMmE4sGfzAtxqqnSShGhbDp1BvjFxy9ZkbWjhUIRSXupJ4A4J4xtrS0lag4ngeRNNOlMa4HNjpgyjT5ZKnnSAqJS6McoBz-P3qOZTy13qkLRHv4BA`

var expected4 = `eyAidXNlcm5hbWUiOiAiYWRtaW4iLCAicGFzc3dvcmQiOiAiZXlKaGJHY2lPaUpTVXpJMU5pSXNJblI1Y0NJNklrcFhWQ0o5LmV5SnBjM01pT2lKcmRXSmxjbTVsZEdWekwzTmxjblpwWTJWaFkyTnZkVzUwSWl3aWEzVmlaWEp1WlhSbGN5NXBieTl6WlhKMmFXTmxZV05qYjNWdWRDOXVZVzFsYzNCaFkyVWlPaUppWkhNdGNHVnlZMlZ3ZEc5eUlpd2lhM1ZpWlhKdVpYUmxjeTVwYnk5elpYSjJhV05sWVdOamIzVnVkQzl6WldOeVpYUXVibUZ0WlNJNkluQmxjbU5sY0hSdmNpMXpZMkZ1Ym1WeUxYTmhMWFJ2YTJWdUxXWnRPV3M0SWl3aWEzVmlaWEp1WlhSbGN5NXBieTl6WlhKMmFXTmxZV05qYjNWdWRDOXpaWEoyYVdObExXRmpZMjkxYm5RdWJtRnRaU0k2SW5CbGNtTmxjSFJ2Y2kxelkyRnVibVZ5TFhOaElpd2lhM1ZpWlhKdVpYUmxjeTVwYnk5elpYSjJhV05sWVdOamIzVnVkQzl6WlhKMmFXTmxMV0ZqWTI5MWJuUXVkV2xrSWpvaU4yVm1PVE5qTnprdE1qSTBNQzB4TVdVNExXSTFOVGd0TURabFpHRTRZelV3T0daaElpd2ljM1ZpSWpvaWMzbHpkR1Z0T25ObGNuWnBZMlZoWTJOdmRXNTBPbUprY3kxd1pYSmpaWEIwYjNJNmNHVnlZMlZ3ZEc5eUxYTmpZVzV1WlhJdGMyRWlmUS5OaDZhaF9GSUhTVTJ6ZDUwMmRxLV9ndkVha2YxT2ZkSU42VG1hckZIejVDMDVDU2pQRWZpNFI5NmdqQkRXa3V5bkZGRHl4RmlkZFdiSTlZakhSX0h5bFM5a2ZlbFVQNXM2ZlZqSHl3YU5yS0tnZm1COUx6a1U2N0xVb2Noa0lydUxJeXpWYmJEVjBOTXdPYUU0TTFWVl9fZWpuM1R3SnB5YjBRM2w5ZE1jWkRjYmlFTll4ZlJ0Tk5RNE5fY2NSNTFYa0dPUjB5U09uZU9ad0NIZ1ZFNG1saURZdHBQR2VuS3RNZDZkWE1tRTRzR2Z6QXR4cXFuU1NoR2hiRHAxQnZqRnh5OVprYldqaFVJUlNYdXBKNEE0SjR4dHJTMGxhZzRuZ2VSTk5PbE1hNEhOanBneWpUNVpLbm5TQXFKUzZNY29Cei1QM3FPWlR5MTNxa0xSSHY0QkEiIH0=`

func TestEncoderLongPassword4(t *testing.T) {
	header := encodeAuthHeader("admin", password4)
	if header != expected4 {
		t.Errorf("got\n%s\nexpected\n%s\n", header, expected4)
	}

	header2 := base64Encode(data4)
	if header2 != expected4 {
		t.Errorf("got\n%s\nexpected\n%s", header2, expected4)
	}
}

// func TestDockerEncoder(t *testing.T) {
// 	username := "admin"
// 	header, err := dockerEncodeAuthHeader(username, password1)
// 	if err != nil {
// 		panic(err)
// 	}
// 	if "header" != expected1 {
// 		t.Errorf("\ngot \n%s\nexpected \n%s", header, expected1)
// 	}
// }
//
// func TestDockerEncoderShortPassword(t *testing.T) {
// 	header, err := dockerEncodeAuthHeader("admin", password2)
// 	if err != nil {
// 		panic(err)
// 	}
// 	if header != expected2 {
// 		t.Errorf("got %s, expected %s", header, expected2)
// 	}
// }
